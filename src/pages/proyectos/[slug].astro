---
// src/pages/proyectos/[slug].astro
import type { GetStaticPaths } from "astro";
import { getCollection } from 'astro:content';
import BaseLayout from "../../layouts/BaseLayout.astro";

import { slide } from 'astro:transitions';


// Obtiene el slug desde la URL
const { slug } = Astro.params;

// Obtiene todos los proyectos
const proyectos = await getCollection('proyectos');

// Busca el proyecto por slug
const proyecto = proyectos.find((proj) => proj.slug === slug);

if (!proyecto) {
  throw new Error(`Proyecto con slug "${slug}" no encontrado.`);
}

// Define las rutas dinámicas que se generan en build
export const getStaticPaths: GetStaticPaths = async () => {
  const proyectos = await getCollection('proyectos');

  return proyectos.map((proyecto) => ({
    params: { slug: proyecto.slug,
     },
  }));
};
---

<BaseLayout title={proyecto.data.titulo}>

  <main class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-4" transition:name=`titulo-${slug}`>{proyecto.data.titulo}</h1>
    <p class="mb-6" transition:name=`des-${slug}`>{proyecto.data.descripcion}</p>

    <!-- Puedes renderizar más info desde el frontmatter aquí -->
    <ul class="flex gap-4 flex-wrap mb-8">
      {proyecto.data.tecnologias.map((tec) => (
        <li class="bg-gray-100 px-3 py-1 rounded text-sm text-gray-700 dark:bg-gray-700 dark:text-white">
          {tec}
        </li>
      ))}
    </ul>
  </main>
</BaseLayout>
