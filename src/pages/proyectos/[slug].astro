---
import type { GetStaticPaths } from "astro";
import { getCollection, render} from 'astro:content';
import { imagenesProyectos } from '../../utils/proyectosImagenes.js';

//Components
import Titulo from "../../components/proyectos/Titulo.astro";

//Layout
import BaseLayout from "../../layouts/BaseLayout.astro";

const { slug } = Astro.params;

// Obtiene todos los proyectos
const proyectos = await getCollection('proyectos');


// Busca el proyecto por slug
const proyecto = proyectos.find((proj) => proj.slug === slug);

if (!proyecto) {
  throw new Error(`Proyecto con slug "${slug}" no encontrado.`);
}

// Define las rutas dinÃ¡micas que se generan en build
export const getStaticPaths: GetStaticPaths = async () => {
  const proyectos = await getCollection('proyectos');
  return proyectos.map((proyecto) => ({
    params: { slug: proyecto.slug },
    props: { proyecto },
  }));
};

const { Content } = await render(proyecto);
const { titulo, descripcion, tecnologias, imagenes} = proyecto.data;
---

<BaseLayout title={proyecto.data.titulo}>
  <Titulo titulo={proyecto.data.titulo} descripcion={proyecto.data.descripcion} tecnologias={proyecto.data.tecnologias} slug={proyecto.slug}/>
  <Content />
</BaseLayout>
